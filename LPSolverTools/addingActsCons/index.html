<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
    <title>Adding activities and constraints</title>
    <style>
        html {
            background-color: #151617;
            color: white;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        button {
            background-color: #20324d;
            color: white;
            border: none;
            /* border-radius: 5px; */
            padding: 2px 10px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            margin-right: 10px;
        }

        button:hover {
            background-color: #0056b3;
        }

        button:active {
            /* transform: scale(0.98); */
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        input {
            width: 50px;
            margin-right: 5px;
            background-color: #212425;
            border: 1px solid #444;
            color: white;
            margin-left: 10px;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        select {
            margin-left: 5px;
            background-color: #212425;
            border: 1px solid #444;
            color: white;
        }

        .row {
            display: flex;
            margin-bottom: 10px;
            align-items: center;
        }

        .cell {
            /* width: 80px; */
            text-align: right;
            margin-right: 5px;
            box-sizing: border-box;
        }

        .highlight {
            color: greenyellow;
        }

        .header-row {
            font-weight: bold;
        }

        label {
            margin-right: 20px;
        }

        input[type="radio"] {
            margin-right: 5px;
        }

        p {
            font-weight: bold;
            color: white;
        }

        .constraint {
            margin-bottom: 10px;
        }

        .tableauContainer,
        .tableauContainer2 {
            margin-bottom: 20px;
            /* height: 300px; */
            overflow-y: auto;
            overflow-x: auto;
            width: 100%;
        }

        .tableauContainer .row,
        .tableauContainer2 .row {
            flex-wrap: nowrap;
        }

        .tableauContainer .cell,
        .tableauContainer2 .cell {
            min-width: 95px;
        }

        #objectiveFunction,
        #constraintsContainer {
            margin-top: 20px;
        }

        .extraDistance {
            margin-left: 50px;
        }



        #unfixed-tab {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            /* Adjust the number and width of columns as needed */
            gap: 20px;
            /* Space between columns */
        }

        .yellow-text {
            color: yellow;
        }
    </style>
</head>

<body>
    <h1>Adding activities and constraints</h1>

    <h3 id="loadingStatus">Loading...</h3>

    <div hidden id="hiddenUntilLoad">
        <div>
            <label><input type="radio" name="problemType" value="Max" checked> Max</label>
            <label><input type="radio" name="problemType" value="Min"> Min</label>
        </div>
        <p id="problemTypeText">Problem is: Max</p>
        <div>
            <label><input type="radio" name="absProblemType" value="On"> Abs On</label>
            <label><input type="radio" name="absProblemType" value="Off" checked> Abs Off</label>
        </div>
        <p id="absProblemTypeText">absolute rule is: Off</p>

        <p id="problemTypeText">Problem is: Max</p>

        <div class="row">
            <button id="addDecisionVar">decision variables +</button>
            <button id="removeDecisionVar">decision variables -</button>
        </div>

        <div id="objectiveFunction" class="row"></div>

        <div class="row">
            <button id="addConstraint">Constraint +</button>
            <button id="removeConstraint">Constraint -</button>
        </div>

        <div id="constraintsContainer"></div>

        <div>
            <label><input type="radio" name="choiceProblemType" value="activities" checked> adding activities</label>
            <label><input type="radio" name="choiceProblemType" value="constraints"> adding constraints</label>
        </div>
        <p id="choiceProblemTypeText">the current problem is adding activities</p>

        <br>
        <div id="problemTypeContainer"></div>

        <div id="extra"></div>

        <div class="row">
            <button id="solveButton">Solve</button>
            <button id="resetButton" style="margin-left: 25px; background-color: red">Reset</button>
        </div>
        <br>

        <div id="output"></div>

        <br>
        <button id="reoptimizeBtn">Optimize again</button>

    </div>

    <script>
        let problemType = "Max";
        let absProblemType = "Off";
        let choiceProblemType = "activities";
        let amtOfObjVars = 2;
        let amtOfConstraints = 1;
        let objFunc = [0.0, 0.0];
        let constraints = [[0.0, 0.0, 0.0, 0.0]];
        let signItems = ["<=", ">="];
        let signItemsChoices = [0];

        let activity = [0.0, 0.0];

        let amtOfAddingConstraints = 1;
        let addingConstraints = [];
        let addingSignItemsChoices = [0];

        let rowsReversed = "Off";

        let negRule = "Off";

        function updateProblemType() {
            problemType = document.querySelector('input[name="problemType"]:checked').value;
            document.getElementById("problemTypeText").innerText = "Problem is: " + problemType;
        }
        function updateAbsProblemType() {
            absProblemType = document.querySelector('input[name="absProblemType"]:checked').value;
            document.getElementById("absProblemTypeText").innerText = "absolute rule is: " + absProblemType;
        }
        function updateChoiceProblemType() {
            choiceProblemType = document.querySelector('input[name="choiceProblemType"]:checked').value;
            document.getElementById("choiceProblemTypeText").innerText = "the current problem is adding " + choiceProblemType;
            updateChoices();
        }
        function updateReverseRows() {
            rowsReversed = document.querySelector('input[name="rowsReversed"]:checked').value;
            document.getElementById("rowsReversedText").innerText = "reverse rows: " + rowsReversed;
        }
        function updateKeepSlack() {
            negRule = document.querySelector('input[name="keepSlack"]:checked').value;
            document.getElementById("keepSlackText").innerText = "keep slack basic: " + negRule;
        }

        // Set default selection to "Max"
        // document.addEventListener('DOMContentLoaded', function () {
        //     document.querySelector('input[value="Max"]').checked = true;
        // });

        function updateObjectiveFunction() {
            const objFuncContainer = document.getElementById("objectiveFunction");
            objFuncContainer.innerHTML = "";

            for (let i = 0; i < amtOfObjVars; i++) {
                const input = document.createElement("input");
                input.type = "number";
                input.value = objFunc[i];
                input.oninput = (e) => {
                    objFunc[i] = parseFloat(e.target.value);
                };

                const label = document.createElement("span");
                label.innerText = `x${i + 1}`;

                objFuncContainer.appendChild(input);
                objFuncContainer.appendChild(label);
            }
        }

        function updateConstraints() {
            const container = document.getElementById("constraintsContainer");
            container.innerHTML = "";

            for (let i = 0; i < amtOfConstraints; i++) {
                const constraintRow = document.createElement("div");
                constraintRow.className = "constraint";

                for (let j = 0; j < amtOfObjVars; j++) {
                    const input = document.createElement("input");
                    input.type = "number";
                    input.value = constraints[i][j];
                    input.oninput = (e) => {
                        constraints[i][j] = parseFloat(e.target.value);
                    };

                    const label = document.createElement("span");
                    label.innerText = `x${j + 1}`;

                    constraintRow.appendChild(input);
                    constraintRow.appendChild(label);
                }

                const signSelect = document.createElement("select");
                signItems.forEach((sign, index) => {
                    const option = document.createElement("option");
                    option.value = index;
                    option.innerText = sign;
                    signSelect.appendChild(option);
                });
                signSelect.value = signItemsChoices[i];
                signSelect.onchange = (e) => {
                    signItemsChoices[i] = parseInt(e.target.value);
                    constraints[i][amtOfObjVars + 1] = signItemsChoices[i];
                };

                const rhsInput = document.createElement("input");
                rhsInput.type = "number";
                rhsInput.value = constraints[i][amtOfObjVars];
                rhsInput.oninput = (e) => {
                    constraints[i][amtOfObjVars] = parseFloat(e.target.value);
                };

                constraintRow.appendChild(signSelect);
                constraintRow.appendChild(rhsInput);

                container.appendChild(constraintRow);
            }
        }

        document.querySelectorAll('input[name="problemType"]').forEach(radio => {
            radio.onchange = updateProblemType;
        });
        document.querySelectorAll('input[name="absProblemType"]').forEach(radio => {
            radio.onchange = updateAbsProblemType;
        });
        document.querySelectorAll('input[name="choiceProblemType"]').forEach(radio => {
            radio.onchange = updateChoiceProblemType;
        });

        document.getElementById("addDecisionVar").onclick = () => {
            amtOfObjVars++;
            objFunc.push(0.0);
            constraints.forEach(constraint => constraint.splice(amtOfObjVars - 1, 0, 0.0));
            updateObjectiveFunction();
            updateConstraints();

            updateNewConstraints()
        };

        document.getElementById("removeDecisionVar").onclick = () => {
            if (amtOfObjVars > 2) {
                amtOfObjVars--;
                objFunc.pop();
                constraints.forEach(constraint => constraint.splice(amtOfObjVars, 1));
                updateObjectiveFunction();
                updateConstraints();

                updateNewConstraints()
            }
        };

        document.getElementById("addConstraint").onclick = () => {
            amtOfConstraints++;
            const newConstraint = new Array(amtOfObjVars).fill(0.0);
            newConstraint.push(0.0);  // for sign
            newConstraint.push(0.0);  // for rhs
            constraints.push(newConstraint);
            signItemsChoices.push(0);
            updateConstraints();

            activity.push(0.0)

            updateChoices()
        };

        document.getElementById("removeConstraint").onclick = () => {
            if (amtOfConstraints > 1) {
                amtOfConstraints--;
                constraints.pop();
                signItemsChoices.pop();
                updateConstraints();

                activity.pop()
                updateChoices()
            }
        };

        function resetRadios() {
            document.querySelector('input[value="Max"]').checked = true;
            const radioButtons = document.querySelectorAll('input[value="Off"]');
            radioButtons.forEach(radioButton => {
                radioButton.checked = true;
            });

            document.querySelector('input[value="activities"]').checked = true;
        }

        document.getElementById("resetButton").onclick = () => {
            amtOfObjVars = 2;
            amtOfConstraints = 1;
            objFunc = [0.0, 0.0];
            constraints = [[0.0, 0.0, 0.0, 0.0]];
            signItems = ["<=", ">="];
            signItemsChoices = [0];

            activity = [0.0, 0.0]

            amtOfAddingConstraints = 1;
            addingConstraints = [];
            addingSignItemsChoices = [0];

            problemType = "Max";
            absProblemType = "Off";

            choiceProblemType = "activities";
            negRule = "Off";
            rowsReversed = "Off";

            updateChoices();

            updateObjectiveFunction();
            updateConstraints();
            resetRadios();
        };

        function updateActivityInputs() {
            const container = document.getElementById('problemTypeContainer');
            container.innerHTML = "";

            extraContainer = document.getElementById('extra');
            extraContainer.innerHTML = "";

            for (let i = 0; i < activity.length; i++) {
                const row = document.createElement('div');
                row.className = 'constraint';

                const input = document.createElement('input');
                input.type = 'number';
                input.value = activity[i];
                input.addEventListener('input', (event) => {
                    activity[i] = parseFloat(event.target.value);
                });

                const label = document.createElement('span');
                label.textContent = i === 0 ? 'x' : `c${i}`;

                row.appendChild(input);
                row.appendChild(label);
                container.appendChild(row);
            }

        }

        function updateNewConstraints() {
            const container = document.getElementById("newConstraintsContainer");

            if (!container) {
                return;
            }
            container.innerHTML = "";

            for (let i = 0; i < amtOfAddingConstraints; i++) {
                if (addingConstraints.length <= i) {
                    addingConstraints.push(new Array(amtOfObjVars + 2).fill(0.0));
                }

                const constraintRow = document.createElement("div");
                constraintRow.className = "constraint";

                for (let j = 0; j < amtOfObjVars; j++) {
                    const input = document.createElement("input");
                    input.type = "number";
                    input.value = addingConstraints[i][j];
                    input.oninput = (e) => {
                        addingConstraints[i][j] = parseFloat(e.target.value);
                    };

                    const label = document.createElement("span");
                    label.innerText = `x${j + 1}`;

                    constraintRow.appendChild(input);
                    constraintRow.appendChild(label);
                }

                const signSelect = document.createElement("select");
                signItems.forEach((sign, index) => {
                    const option = document.createElement("option");
                    option.value = index;
                    option.innerText = sign;
                    signSelect.appendChild(option);
                });
                signSelect.value = addingSignItemsChoices[i];
                signSelect.onchange = (e) => {
                    addingSignItemsChoices[i] = parseInt(e.target.value);
                    addingConstraints[i][amtOfObjVars + 1] = addingSignItemsChoices[i];
                };

                const rhsInput = document.createElement("input");
                rhsInput.type = "number";
                rhsInput.value = addingConstraints[i][amtOfObjVars];
                rhsInput.oninput = (e) => {
                    addingConstraints[i][amtOfObjVars] = parseFloat(e.target.value);
                };

                constraintRow.appendChild(signSelect);
                constraintRow.appendChild(rhsInput);

                container.appendChild(constraintRow);
            }
            document.getElementById('problemTypeContainer').appendChild(container);

        }


        function updateAddingNewConstraints() {
            const container = document.getElementById('problemTypeContainer');
            container.innerHTML = "";

            const row = document.createElement("div");
            row.className = "row";

            const addButton = document.createElement("button");
            addButton.id = "addNewConstraint";
            addButton.textContent = "New Constraint +";

            const removeButton = document.createElement("button");
            removeButton.id = "removeNewConstraint";
            removeButton.textContent = "New Constraint -";

            row.appendChild(addButton);
            row.appendChild(removeButton);

            container.appendChild(row);

            if (document.getElementById('newConstraintsContainer')) {
                container.removeChild(row);
            }
            const newConstraint = document.createElement("div");
            newConstraint.id = "newConstraintsContainer";
            newConstraint.innerHTML = "";

            container.appendChild(newConstraint);

            extraContainer = document.getElementById('extra');
            extraContainer.innerHTML = "";

            existing = document.querySelector('div > label > input[name="rowsReversed"]');
            if (existing) existing.parentNode.remove();

            existing = document.querySelector('div > label > input[name="keepSlack"]');
            if (existing) existing.parentNode.remove();

            div = document.createElement('div');
            div.innerHTML = `
                <label><input type="radio" name="rowsReversed" value="On"> reverse rows On</label>
                <label><input type="radio" name="rowsReversed" value="Off" checked> reverse rows Off</label>
                <p id="rowsReversedText">reverse rows: Off</p>
            `;

            extraContainer.appendChild(div);

            div = document.createElement('div');
            div.innerHTML = `
                <label><input type="radio" name="keepSlack" value="On"> keep slack basic on</label>
                <label><input type="radio" name="keepSlack" value="Off" checked> keep slack basic off</label>
                <p id="keepSlackText">keep slack basic: Off</p>
            `;

            extraContainer.appendChild(div);

            document.querySelectorAll('input[name="rowsReversed"]').forEach(radio => {
                radio.onchange = updateReverseRows;
            });

            document.querySelectorAll('input[name="keepSlack"]').forEach(radio => {
                radio.onchange = updateKeepSlack;
            });

            document.getElementById("addNewConstraint").onclick = () => {
                amtOfAddingConstraints++;
                const newConstraint = new Array(amtOfObjVars).fill(0.0);
                newConstraint.push(0.0);  // for sign
                newConstraint.push(0.0);  // for rhs
                addingConstraints.push(newConstraint);
                addingSignItemsChoices.push(0);
                updateNewConstraints();
            };

            document.getElementById("removeNewConstraint").onclick = () => {
                if (amtOfAddingConstraints > 1) {
                    amtOfAddingConstraints--;
                    addingConstraints.pop();
                    addingSignItemsChoices.pop();
                    updateNewConstraints();
                }
            };
            updateNewConstraints();
        }

        function updateChoices() {
            if (choiceProblemType == "activities") {
                document.querySelectorAll('.tableauContainer').forEach(elem => elem.remove());
                document.querySelectorAll('.tableauContainer2').forEach(elem => elem.remove());
                updateActivityInputs();
            }
            else {
                document.querySelectorAll('.tableauContainer').forEach(elem => elem.remove());
                document.querySelectorAll('.tableauContainer2').forEach(elem => elem.remove());
                updateAddingNewConstraints();
            }
        }

        function getObjFunc() {
            return objFunc;
        }

        function getConstraints() {
            return constraints;
        }

        function getNewConstraints() {
            return addingConstraints;
        }

        function getProblemType() {
            return problemType;
        }

        function getActivity() {
            return activity;
        }

        function getAbsProblemType() {
            return absProblemType;
        }

        function getKeepSlack() {
            return negRule;
        }

        function getReverseRows() {
            return rowsReversed;
        }

        function getChoiceProblemType() {
            return choiceProblemType;
        }

        // Initial render
        updateChoices();
        updateObjectiveFunction();
        updateConstraints();
        resetRadios();
    </script>

    <py-config>
        packages = [
        "sympy",
        ]
        [[fetch]]
        files = [
        "./addingactscons.py",
        "../mathPrelim/mathpreliminaries.py",
        "../dual/dualsimplex.py",
        ]
    </py-config>
    <script type="py">
        from pyscript import document, display, when, window
        from js import console, getObjFunc, getConstraints, getProblemType, getNewConstraints, getActivity, getAbsProblemType, getReverseRows, getKeepSlack, getChoiceProblemType
        import copy

        from addingactscons import AddingActsCons

        console.clear();
    
        document.getElementById("hiddenUntilLoad").removeAttribute("hidden");
        document.getElementById("loadingStatus").hidden = True;

        window.isIframeLoaded = True;

        # Initialize object
        addingActsCons = AddingActsCons()

        def renderOutput():
            if addingActsCons.problemState:
                for elem in document.querySelectorAll('.tableauContainer'):
                    elem.remove()

                container = document.createElement('div')
                container.className = 'tableauContainer'

                for i in range(len(addingActsCons.actDisplayCol)):
                    headerRow = document.createElement('div')
                    headerRow.className = 'row header-row'
                    headerRow.style = "margin-top: 20px;"

                    if i == 0:
                        headerCell = document.createElement('div')
                        headerCell.className = 'cell'
                        headerCell.textContent = "Activity"
                        headerCell.style = "text-align: right;"
                        headerRow.appendChild(headerCell)
                    else:
                        headerCell = document.createElement('div')
                        headerCell.className = 'cell'
                        headerCell.textContent = "Constraint {}".format(i)
                        headerRow.appendChild(headerCell)
                    
                    cellDiv = document.createElement('div')
                    cellDiv.className = 'cell extraDistance'
                    cellDiv.textContent = "{:>15.3f}".format(float(addingActsCons.actDisplayCol[i]))
                    headerRow.appendChild(cellDiv)

                    container.appendChild(headerRow)
                    document.getElementById("output").appendChild(container)
            else:
                for elem in document.querySelectorAll('.tableauContainer'):
                    elem.remove()

                container = document.createElement('div')
                container.className = 'tableauContainer'

                unfixedTab = addingActsCons.unfixedTab
                addedConstraints = addingActsCons.addedConstraints

                h3Elm = document.createElement('h3')
                h3Elm.textContent = "Unfixed Tab:"
                container.appendChild(h3Elm)

                for i in range(len(unfixedTab)):
                    headerRow = document.createElement('div')
                    headerRow.className = 'row header-row'

                    for j in range(len(unfixedTab[i])):
                        if i >= (len(unfixedTab) - len(addedConstraints)):
                            headerCell = document.createElement('div')
                            headerCell.className = 'cell'
                            headerCell.textContent = "{:>9.3f}".format(float(unfixedTab[i][j]))
                            headerCell.style.color = "yellow"
                            headerRow.appendChild(headerCell)
                        else:
                            headerCell = document.createElement('div')
                            headerCell.className = 'cell'
                            headerCell.textContent = "{:>9.3f}".format(float(unfixedTab[i][j]))
                            headerRow.appendChild(headerCell)

                    container.appendChild(headerRow)
                    document.getElementById("output").appendChild(container)

                fixedTab = addingActsCons.fixedTab

                h3Elm = document.createElement('h3')
                h3Elm.textContent = "fixed Tab:"
                container.appendChild(h3Elm)
                
                for i in range(len(fixedTab)):
                    headerRow = document.createElement('div')
                    headerRow.className = 'row header-row'

                    for j in range(len(fixedTab[i])):
                        if i >= (len(fixedTab) - len(addedConstraints)):
                            headerCell = document.createElement('div')
                            headerCell.className = 'cell'
                            headerCell.textContent = "{:>9.3f}".format(float(fixedTab[i][j]))
                            headerCell.style.color = "yellow"
                            headerRow.appendChild(headerCell)
                        else:
                            headerCell = document.createElement('div')
                            headerCell.className = 'cell'
                            headerCell.textContent = "{:>9.3f}".format(float(fixedTab[i][j]))
                            headerRow.appendChild(headerCell)

                    container.appendChild(headerRow)
                    document.getElementById("output").appendChild(container)
            
        def renderReOpTables():
            if getProblemType() == "Max":
                isMin = False
            else:
                isMin = True

            if addingActsCons.problemState:
                tab = copy.deepcopy(addingActsCons.changingTable)

                for i in range(len(tab)):
                    tab[i].insert(len(addingActsCons.objFunc), float(addingActsCons.actDisplayCol[i]))

                try:
                    addingActsCons.newTableaus, addingActsCons.changingVars, addingActsCons.optimalSolution, addingActsCons.IMPivotCols, addingActsCons.IMPivotRows, addingActsCons.IMHeaderRow = addingActsCons.dual.doDualSimplex([
                    ], [], isMin, tab)

                    print("len")
                    print(len(addingActsCons.changingTable))

                    addingActsCons.IMHeaderRow.clear()

                    for i in range(len(addingActsCons.newTableaus[-1][-1])):
                        if i < (len(addingActsCons.objFunc) + 1):
                            addingActsCons.IMHeaderRow.append(f"x{i+1}")
                        elif i == (len(addingActsCons.newTableaus[-1][-1]) - 1):
                            addingActsCons.IMHeaderRow.append(f"rhs")
                        else:
                            addingActsCons.IMHeaderRow.append(f"h{i+1}")


                except Exception as e:
                    print("math error in Optimize again:", e)
            else:
                tab = copy.deepcopy(addingActsCons.fixedTab)

                try:
                    addingActsCons.newTableaus, addingActsCons.changingVars, addingActsCons.optimalSolution, addingActsCons.IMPivotCols, addingActsCons.IMPivotRows, addingActsCons.IMHeaderRow = addingActsCons.dual.doDualSimplex([
                    ], [], isMin, tab)

                    addingActsCons.IMHeaderRow.clear()

                    for i in range(len(addingActsCons.newTableaus[-1][-1])):
                        if i <= (len(addingActsCons.objFunc) - 1):
                            addingActsCons.IMHeaderRow.append(f"x{i+1}")
                        elif i == (len(addingActsCons.newTableaus[-1][-1]) - 1):
                            addingActsCons.IMHeaderRow.append(f"rhs")
                        else:
                            addingActsCons.IMHeaderRow.append(f"h{i+1}")

                except Exception as e:
                    print("math error in Optimize again:", e)

            # Remove existing tableaus
            for elem in document.querySelectorAll('.tableauContainer2'):
                elem.remove()

            container = document.createElement('div')
            container.className = 'tableauContainer2'

            tableaus = copy.deepcopy(addingActsCons.newTableaus) 
            tHeader = copy.deepcopy(addingActsCons.IMHeaderRow)
            tCol = copy.deepcopy(addingActsCons.IMPivotCols)
            tRow = copy.deepcopy(addingActsCons.IMPivotRows)

            tCol.append(-1)
            tRow.append(-1)

            tHeader.insert(0, f"t - 0")

            for i, tableau in enumerate(tableaus):
                tableauHeader = document.createElement('h3')
                tableauHeader.textContent = f"Tableau {i + 1}"
                container.appendChild(tableauHeader)

                # Create header row
                del tHeader[0]
                tHeader.insert(0, f"t - {i+1}")
                headerRow = document.createElement('div')
                headerRow.className = 'row header-row'
                for header in tHeader:
                    headerCell = document.createElement('div')
                    headerCell.className = 'cell'
                    headerCell.textContent = header
                    headerRow.appendChild(headerCell)
                container.appendChild(headerRow)

                # Create tableau rows
                for j, row in enumerate(tableau):
                    rowDiv = document.createElement('div')
                    rowDiv.className = 'row'
                    if j == tRow[i] and tRow[i] != -1:
                        rowDiv.classList.add('highlight')

                    rowLabel = document.createElement('div')
                    rowLabel.className = 'cell'
                    rowLabel.textContent = 'w' if j == 0 else f'c {j}'
                    rowDiv.appendChild(rowLabel)

                    for k, value in enumerate(row):
                        cell = document.createElement('div')
                        cell.className = 'cell'
                        # value = f"{value:.3f}"
                        cell.textContent = f"{value:.3f}"

                        if k == tCol[i] and tCol[i] != -1:
                            cell.classList.add('highlight')
                        rowDiv.appendChild(cell)
                    container.appendChild(rowDiv)
                document.body.appendChild(container)
                # document.getElementById("hiddenUntilLoad").appendChild(container)


        @when("click", "#solveButton")
        def solve(event):
            try: 
                addingActsCons.activity = getActivity().to_py();
                addingActsCons.addingConstraints = getNewConstraints().to_py();
                addingActsCons.objFunc = getObjFunc().to_py();
                addingActsCons.constraints= getConstraints().to_py();

                if getProblemType() == "Max":
                    isMin = False
                else:
                    isMin = True

                if getAbsProblemType() == "On":
                    absRule = True
                else:
                    absRule = False
                addingActsCons.absRule = absRule

                if getKeepSlack() == "On":
                    negRule = True
                else:
                    negRule = False
                addingActsCons.negRuleState = negRule

                if getReverseRows() == "On":
                    rowsReversed = True
                else:
                    rowsReversed = False
                addingActsCons.reverseRowsState = rowsReversed

                # addingActsCons.objFunc, addingActsCons.constraints, isMin, addingActsCons.addingConstraints = addingActsCons.testInput(0)

                if getChoiceProblemType() == "activities":
                    addingActsCons.problemState = True
                else:
                    addingActsCons.problemState = False

                a = copy.deepcopy(addingActsCons.objFunc)
                b = copy.deepcopy(addingActsCons.constraints)

                if addingActsCons.problemState:
                    c = copy.deepcopy(addingActsCons.activity)
                    addingActsCons.actDisplayCol, addingActsCons.changingTable = addingActsCons.doAddActivity(
                        a, b, isMin, c, addingActsCons.absRule)
                else:
                    e = copy.deepcopy(addingActsCons.addingConstraints)
                    print(e)
                    addingActsCons.addedConstraints = addingActsCons.addingConstraints
                    addingActsCons.fixedTab, addingActsCons.unfixedTab = addingActsCons.doAddConstraint(
                        a, b, isMin, e, addingActsCons.absRule, addingActsCons.reverseRowsState, addingActsCons.negRuleState)

                
                renderOutput()
                
            except Exception as e:
                for elem in document.querySelectorAll('.error'):
                    elem.remove()
                errorDiv = document.createElement('div')
                errorDiv.className = 'error'
                errorDiv.textContent = "Math Error"
                document.body.appendChild(errorDiv)

        @when("click", "#resetButton")
        def reset(event):
            addingActsCons.reset()
            for elem in document.querySelectorAll('.tableauContainer'):
                elem.remove()
            for elem in document.querySelectorAll('.tableauContainer2'):
                elem.remove()
            for elem in document.querySelectorAll('.error'):
                elem.remove()

        @when("click", "#reoptimizeBtn")
        def reoptimize(event):
            renderReOpTables()
    </script>

</body>

</html>